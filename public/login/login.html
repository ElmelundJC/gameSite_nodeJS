<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>

    <link rel="stylesheet" href="../login/login.css">
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script> -->
</head>
<body>
    <section class="section-nav">
        <header class="header-container">
          <a href="/" class="logo">Spin the wheel</a>
          <ul>
          </ul>
          <ul>
            <a href="/login" class="login-btn">Login</a>
            <a href="/signup" class="signup-btn">Sign up</a>
          </ul>
        </header>  
      </section>

    <section>
        <div class="color"></div>
        <div class="color"></div>
        <div class="color"></div>
        <div class="box">
            <div class="square" style="--i:0;"></div>
            <div class="square" style="--i:1;"></div>
            <div class="square" style="--i:2;"></div>
            <div class="square" style="--i:3;"></div>
            <div class="square" style="--i:4;"></div>
            <div class="container">
                <div class="form">
                    <h2>Login Form</h2>
                    <form id="loginForm">
                        <div class="inputBox">
                            <input type="text" name="email" id="email" autocomplete="off" placeholder="Email">
                        </div>
                        <div class="inputBox">
                            <input type="password" name="password" id="password" autocomplete="off" placeholder="Password">
                        </div>
                        <div class="inputBox">
                            <input type="submit" id="loginBtn" value="Login">
                        </div>
                        <!-- <p class="forget">Forgot Password ? <a href="#">Click Here</a></p> -->
                        <p class="forget">Don't have an account ? <a href="/signup">Sign up</a></p>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <section>
        <div>
          <footer id="footer-id">
            <p id="footer-about">Copyright</p>
          </footer>
        </div>
      </section>

      
      <script>
        document.querySelector('#loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
 
        const signupBtn = document.querySelector('#loginBtn');
        const email = document.querySelector('input[name="email"]');
        const password = document.querySelector('input[name="password"]');
   
        const result = await fetch('/api/users/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              email: email.value,
              password: password.value,
            })
          })
          .then(res => {
            return res.json()
          })
          .then(data => {
            console.log(data)
            if (data.status === 'success') {
              window.location.href = '/indexpage'
            } else {
              window.location.href = '/login'
            }
          })
          .catch(error => console.log(error));
      });

        const footerAbout = document.getElementById('footer-about');
      
        footerAbout.innerText =
          'Â© Copyright ' +
          new Date().getFullYear() +
          ' Celmelund - All Rights Reserved';
      
        console.log(new Date().getFullYear());
      </script>
</body>
</html>